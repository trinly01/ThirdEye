webpackJsonp([6],{358:function(e,t,a){var n=a(224)(a(438),a(476),null,null,null);e.exports=n.exports},367:function(e,t){var a=e.exports={version:"2.5.0"};"number"==typeof __e&&(__e=a)},368:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},369:function(e,t,a){e.exports=!a(368)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},370:function(e,t){var a=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=a)},371:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},372:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},373:function(e,t,a){var n=a(385);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},374:function(e,t){var a=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:a)(e)}},375:function(e,t,a){var n=a(373),r=a(372);e.exports=function(e){return n(r(e))}},376:function(e,t,a){e.exports={default:a(381),__esModule:!0}},377:function(e,t,a){var n=a(370),r=a(367),s=a(386),o=a(390),i=function(e,t,a){var c,u,l,p=e&i.F,d=e&i.G,f=e&i.S,v=e&i.P,m=e&i.B,h=e&i.W,y=d?r:r[t]||(r[t]={}),w=y.prototype,g=d?n:f?n[t]:(n[t]||{}).prototype;d&&(a=t);for(c in a)(u=!p&&g&&void 0!==g[c])&&c in y||(l=u?g[c]:a[c],y[c]=d&&"function"!=typeof g[c]?a[c]:m&&u?s(l,n):h&&g[c]==l?function(e){var t=function(t,a,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,a)}return new e(t,a,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):v&&"function"==typeof l?s(Function.call,l):l,v&&((y.virtual||(y.virtual={}))[c]=l,e&i.R&&w&&!w[c]&&o(w,c,l)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,e.exports=i},378:function(e,t,a){var n=a(395),r=a(388);e.exports=Object.keys||function(e){return n(e,r)}},379:function(e,t,a){var n=a(372);e.exports=function(e){return Object(n(e))}},381:function(e,t,a){a(404),e.exports=a(367).Object.assign},382:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},383:function(e,t,a){var n=a(371);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},384:function(e,t,a){var n=a(375),r=a(401),s=a(400);e.exports=function(e){return function(t,a,o){var i,c=n(t),u=r(c.length),l=s(o,u);if(e&&a!=a){for(;u>l;)if((i=c[l++])!=i)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===a)return e||l||0;return!e&&-1}}},385:function(e,t){var a={}.toString;e.exports=function(e){return a.call(e).slice(8,-1)}},386:function(e,t,a){var n=a(382);e.exports=function(e,t,a){if(n(e),void 0===t)return e;switch(a){case 1:return function(a){return e.call(t,a)};case 2:return function(a,n){return e.call(t,a,n)};case 3:return function(a,n,r){return e.call(t,a,n,r)}}return function(){return e.apply(t,arguments)}}},387:function(e,t,a){var n=a(371),r=a(370).document,s=n(r)&&n(r.createElement);e.exports=function(e){return s?r.createElement(e):{}}},388:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},389:function(e,t){var a={}.hasOwnProperty;e.exports=function(e,t){return a.call(e,t)}},390:function(e,t,a){var n=a(393),r=a(397);e.exports=a(369)?function(e,t,a){return n.f(e,t,r(1,a))}:function(e,t,a){return e[t]=a,e}},391:function(e,t,a){e.exports=!a(369)&&!a(368)(function(){return 7!=Object.defineProperty(a(387)("div"),"a",{get:function(){return 7}}).a})},392:function(e,t,a){"use strict";var n=a(378),r=a(394),s=a(396),o=a(379),i=a(373),c=Object.assign;e.exports=!c||a(368)(function(){var e={},t={},a=Symbol(),n="abcdefghijklmnopqrst";return e[a]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[a]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var a=o(e),c=arguments.length,u=1,l=r.f,p=s.f;c>u;)for(var d,f=i(arguments[u++]),v=l?n(f).concat(l(f)):n(f),m=v.length,h=0;m>h;)p.call(f,d=v[h++])&&(a[d]=f[d]);return a}:c},393:function(e,t,a){var n=a(383),r=a(391),s=a(402),o=Object.defineProperty;t.f=a(369)?Object.defineProperty:function(e,t,a){if(n(e),t=s(t,!0),n(a),r)try{return o(e,t,a)}catch(e){}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(e[t]=a.value),e}},394:function(e,t){t.f=Object.getOwnPropertySymbols},395:function(e,t,a){var n=a(389),r=a(375),s=a(384)(!1),o=a(398)("IE_PROTO");e.exports=function(e,t){var a,i=r(e),c=0,u=[];for(a in i)a!=o&&n(i,a)&&u.push(a);for(;t.length>c;)n(i,a=t[c++])&&(~s(u,a)||u.push(a));return u}},396:function(e,t){t.f={}.propertyIsEnumerable},397:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},398:function(e,t,a){var n=a(399)("keys"),r=a(403);e.exports=function(e){return n[e]||(n[e]=r(e))}},399:function(e,t,a){var n=a(370),r=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return r[e]||(r[e]={})}},400:function(e,t,a){var n=a(374),r=Math.max,s=Math.min;e.exports=function(e,t){return e=n(e),e<0?r(e+t,0):s(e,t)}},401:function(e,t,a){var n=a(374),r=Math.min;e.exports=function(e){return e>0?r(n(e),9007199254740991):0}},402:function(e,t,a){var n=a(371);e.exports=function(e,t){if(!n(e))return e;var a,r;if(t&&"function"==typeof(a=e.toString)&&!n(r=a.call(e)))return r;if("function"==typeof(a=e.valueOf)&&!n(r=a.call(e)))return r;if(!t&&"function"==typeof(a=e.toString)&&!n(r=a.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},403:function(e,t){var a=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++a+n).toString(36))}},404:function(e,t,a){var n=a(377);n(n.S+n.F,"Object",{assign:a(392)})},438:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(376),r=a.n(n),s=a(54),o=(a.n(s),a(99)),i=a.n(o);t.default={data:function(){return{search:"",users:[],companies:[],company:"",store:"",user:{activated:!1,company:{},displayName:"",email:"",store:"",type:"",brand:"",password:"",passwordConfirm:""},userTypes:[{label:"Company manager",value:"Company manager"},{label:"Brand manager",value:"Brand manager"},{label:"Store owner",value:"Store owner"},{label:"Admin",value:"Admin"}]}},mounted:function(){this.$bindAsArray("users",this.$database.ref("users")),this.$bindAsArray("companies",this.$database.ref("companies")),this.$bindAsArray("stores",this.$database.ref("stores")),this.$store.state.user&&this.$store.state.user.data&&"Admin"!==this.$store.state.user.data.type&&this.$router.push("/login")},computed:{filteredUsers:function(){var e=this;return 0!==this.users.length?this.users.filter(function(t){return!!t.displayName&&(-1!==t.displayName.toLowerCase().indexOf(e.search.toLowerCase())||-1!==t.email.toLowerCase().indexOf(e.search.toLowerCase())||-1!==t.type.toLowerCase().indexOf(e.search.toLowerCase()))}):this.users},storeOptions:function(){return i.a.map(this.stores).map(function(e){return{label:e.name,value:e.name}})},companyOptions:function(){return i.a.map(this.companies).map(function(e){var t=i.a.map(e.brands).map(function(e){return{label:e,value:e}});return i.a.assign(e,{label:e.name,value:{name:e.name,brands:t,code:e.code}})})},companyCheck:function(){return this.company}},methods:{activate:function(e,t){this.$auth.usersRef.child(t+"/activated").set(!e)},showBrand:function(e){var t=this;if(e.company){var a=e.company.brands||[];s.Dialog.create({title:e.email,form:{brand:{type:"radio",model:e.brand,items:a}},buttons:["cancel",{label:"Save",handler:function(a){console.log(a.brand),t.$auth.usersRef.child(e[".key"]+"/brand").set(a.brand)}}]})}else s.Toast.create.negative({html:"Add a company first"})},showUser:function(e){console.log("showUser",e),e.company="",e.brand=e.brand||"",this.user=r()({},e),this.isNew=!1,this.$forceUpdate(),this.$refs.newModal.open()},showAddForm:function(){this.isNew=!0,this.$forceUpdate(),this.$refs.newModal.open()},saveNew:function(){var e=this,t=this.user,a=this;console.log(t);var n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;0===t.displayName.length?s.Toast.create.negative({html:"Invalid name"}):n.test(t.email)?t.password.length<6||t.password!==t.passwordConfirm?s.Toast.create.negative({html:"Invalid password"}):0===t.type.length?s.Toast.create.negative({html:"Invalid type"}):"Company manager"!==t.type||t.company.name?(s.Loading.show(),a.$auth2.createUserWithEmailAndPassword(t.email,t.password).then(function(n){delete t.passwordConfirm,delete t.password,t.activated=!1,a.$auth.usersRef.child(n.uid).set(t).then(function(t){e.$refs.newModal.close(),s.Loading.hide()}).catch(function(e){s.Toast.create.negative({html:e.code+": "+e.message}),s.Loading.hide()})}).catch(function(e){s.Toast.create.negative({html:e.code+": "+e.message}),s.Loading.hide()})):s.Toast.create.negative({html:"Invalid Company"}):s.Toast.create.negative({html:"Invalid email"})},saveUpdate:function(){var e=this,t=this.user;if(console.log(t),0===t.displayName.length)s.Toast.create.negative({html:"Invalid name"});else if("Company manager"!==t.type||t.company.name)if("Brand manager"!==t.type||t.company.name||t.brand){s.Loading.show();var a=t[".key"];delete t[".key"],this.$auth.usersRef.child(a).update(t).then(function(t){close(),s.Loading.hide(),e.$refs.newModal.close()}).catch(function(e){s.Toast.create.negative({html:e.code+": "+e.message}),s.Loading.hide()})}else s.Toast.create.negative({html:"Invalid Brand"});else s.Toast.create.negative({html:"Invalid Company"})}}}},476:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"toolbar primary",slot:"header"},[a("q-toolbar-title",{staticClass:"row full-width flex",attrs:{padding:0}},[a("div",{staticClass:"row full-width flex"},[a("span",{staticClass:"auto",staticStyle:{padding:"8px 16px 0px 0px"}},[e._v("User Management "+e._s(e.companyCheck))]),e._v(" "),a("q-search",{staticClass:"primary float-right",staticStyle:{"max-width":"320px"},attrs:{model:e.search},on:{"update:model":function(t){e.search=t}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)])],1),e._v(" "),a("div",{staticClass:"layout-padding"},[a("table",{staticClass:"q-table bordered highlight striped-odd loose full-width responsive"},[e._m(0),e._v(" "),a("tbody",e._l(e.filteredUsers,function(t){return a("tr",{key:t._id,on:{click:function(a){e.showUser(t)}}},[a("td",{staticClass:"text-left"},[e._v(e._s(t.displayName))]),e._v(" "),a("td",{staticClass:"text-right"},[e._v(e._s(t.email))]),e._v(" "),a("td",{staticClass:"text-right"},[e._v(e._s(t.type))]),e._v(" "),a("td",{staticClass:"text-right"},[t.company?a("span",[e._v(e._s(t.company.name))]):e._e()]),e._v(" "),a("td",{staticClass:"text-right"},[t.brand?a("span",[e._v(e._s(t.brand))]):e._e()]),e._v(" "),a("td",{staticClass:"text-right"},[t.store?a("span",[e._v(e._s(t.store))]):e._e()]),e._v(" "),a("td",{staticClass:"text-right"},[a("q-toggle",{attrs:{value:t.activated},on:{input:function(a){e.activate(t.activated,t[".key"])}}})],1)])}))])]),e._v(" "),a("button",{staticClass:"primary circular absolute-bottom-right raised",staticStyle:{bottom:"2em",right:"2em"},on:{click:function(t){e.isNew=!0,e.showAddForm(),e.isNew=!0,e.isNew=!0}}},[a("i",[e._v("add")])]),e._v(" "),a("q-modal",{ref:"newModal",attrs:{noEscDismiss:!1,noBackdropDismiss:!1}},[a("div",{staticClass:"layout-padding"},[a("h4",[e._v(e._s(e.isNew?"Create":"Edit")+" User")]),e._v(" "),a("form",[a("div",{staticClass:"floating-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.user.displayName,expression:"user.displayName"}],staticClass:"full-width",attrs:{required:""},domProps:{value:e.user.displayName},on:{input:function(t){t.target.composing||(e.user.displayName=t.target.value)}}}),e._v(" "),a("label",[e._v("Display Name")])]),e._v(" "),a("div",{staticClass:"floating-label",attrs:{disabled:!e.isNew}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"full-width",attrs:{disabled:!e.isNew,required:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||(e.user.email=t.target.value)}}}),e._v(" "),a("label",{directives:[{name:"show",rawName:"v-show",value:e.isNew,expression:"isNew"}]},[e._v("Email")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isNew,expression:"isNew"}],staticClass:"floating-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"full-width",attrs:{required:"",type:"password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||(e.user.password=t.target.value)}}}),e._v(" "),a("label",[e._v("Password")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isNew,expression:"isNew"}],staticClass:"floating-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.user.passwordConfirm,expression:"user.passwordConfirm"}],staticClass:"full-width",attrs:{required:"",type:"password"},domProps:{value:e.user.passwordConfirm},on:{input:function(t){t.target.composing||(e.user.passwordConfirm=t.target.value)}}}),e._v(" "),a("label",[e._v("Confirm Password")])]),e._v(" "),a("q-select",{attrs:{type:"list",label:"Type",options:e.userTypes},model:{value:e.user.type,callback:function(t){e.user.type=t},expression:"user.type"}}),e._v(" "),"Company manager"===e.user.type||"Brand manager"===e.user.type?a("q-select",{attrs:{type:"list",label:"Company",value:"user.company",options:e.companyOptions},model:{value:e.user.company,callback:function(t){e.user.company=t},expression:"user.company"}}):e._e(),e._v("\n        "+e._s(!e.user.company.name)+"\n        "),"Brand manager"===e.user.type&&e.user.company.name?a("q-select",{attrs:{type:"list",label:"Brand",options:e.user.company.brands},model:{value:e.user.brand,callback:function(t){e.user.brand=t},expression:"user.brand"}}):e._e(),e._v(" "),"Store owner"===e.user.type?a("q-select",{attrs:{type:"list",label:"Store",options:e.storeOptions},model:{value:e.user.store,callback:function(t){e.user.store=t},expression:"user.store"}}):e._e()],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"row pull-right"},[a("button",{staticClass:"primary clear",on:{click:function(t){e.$refs.newModal.close()}}},[e._v("cancel")]),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:e.isNew,expression:"isNew"}],staticClass:"primary",on:{click:e.saveNew}},[e._v("Save")]),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:!e.isNew,expression:"!isNew"}],staticClass:"primary",on:{click:e.saveUpdate}},[e._v("Save")])]),e._v(" "),a("br")])])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("Name")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Email")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Type")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Company")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Brand")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Store")]),e._v(" "),a("th",{staticClass:"text-right"},[e._v("Activated")])])])}]}}});